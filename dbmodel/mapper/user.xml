<?xml version="1.0" encoding="UTF-8"?>
<sql id="user">
	<select id="query">
		select 
			t1.*,t2.name deptName,t3.name pName 
		from
			user t1
		left join
			department t2 on t1.dept = t2.id
		left join
			user t3 on t1.pid = t3.id
		where 1 = 1
			{{if name}}
				and	t1.name like {{name | p}}
			{{/if}}
			{{if dept}}
				and t2.id = {{dept}}
			{{/if}}
			{{if sort}}
				order {{sort}}
			{{/if}}
			{{if offset}}
				limit {{offset}},{{pageSize}}
			{{/if}}
	</select>
	
	<select id="count">
		select 
			count(1)
		from
			user t1
		left join
			department t2 on t1.dept = t2.id
		where 1 = 1
			{{if name}}
				and	t1.name like {{name | p}}
			{{/if}}
			{{if dept}}
				and t2.id = {{dept}}
			{{/if}}
	</select>

</sql>